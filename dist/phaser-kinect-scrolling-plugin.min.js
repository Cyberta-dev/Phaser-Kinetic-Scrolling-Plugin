!function(t){"use strict";t.Plugin.KineticScrolling=function(i,e){t.Plugin.call(this,i,e),this.kineticMovement=!0,this.dragging=!1,this.autoScroll=!1,this.timeConstant=325,this.startX=0,this.timestamp=0,this.velocity=0,this.amplitude=0,this.callbackID=0},t.Plugin.KineticScrolling.prototype=Object.create(t.Plugin.prototype),t.Plugin.KineticScrolling.prototype.constructor=t.Plugin.KineticScrolling,t.Plugin.KineticScrolling.prototype.init=function(t){void 0!==t&&(this.kineticMovement=t)},t.Plugin.KineticScrolling.prototype.start=function(){this.game.input.onDown.add(this.beginMove,this),this.callbackID=this.game.input.addMoveCallback(this.moveCamera,this),this.game.input.onUp.add(this.endMove,this)},t.Plugin.KineticScrolling.prototype.beginMove=function(){this.startX=this.game.input.x,this.dragging=!0,this.timestamp=Date.now(),this.velocity=this.amplitude=0},t.Plugin.KineticScrolling.prototype.moveCamera=function(t,i){if(this.dragging){var e=i-this.startX;this.startX=i,this.now=Date.now();var n=this.now-this.timestamp;this.timestamp=this.now;var o=1e3*e/(1+n);this.velocity=.8*o+.2*this.velocity,this.game.camera.x-=e}},t.Plugin.KineticScrolling.prototype.endMove=function(){this.dragging=!1,this.autoScroll=!1,this.kineticMovement&&(this.velocity>10||this.velocity<-10)&&(this.amplitude=.8*this.velocity,this.now=Date.now(),this.target=Math.round(this.game.camera.x-this.amplitude),this.autoScroll=!0)},t.Plugin.KineticScrolling.prototype.update=function(){if(this.autoScroll&&0!=this.amplitude){this.elapsed=Date.now()-this.timestamp;var t=-this.amplitude*Math.exp(-this.elapsed/this.timeConstant);t>.5||-.5>t?this.game.camera.x=this.target-t:(this.autoScroll=!1,this.game.camera.x=this.target)}},t.Plugin.KineticScrolling.prototype.stop=function(){this.game.input.onDown.add(this.beginMove,this),this.game.input.deleteMoveCallback(this.callbackID),this.game.input.onUp.add(this.endMove,this)}}(Phaser);